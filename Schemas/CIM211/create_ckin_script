#!/bin/bash
###########################################################################
##
## build checkin script for new DMTF CIM Schema files files:
##
## This file was used when CIM Schema Version 2.11 was installed. 
## It is not inteneded for general use. It is available here as 
## further documentation of the CIM Schema install process and for 
## future reference when new CIM Schema versions are installed.
##
## This bash shell script file creates a bash shell checkin script to use 
## to checkin the new DMTF files.
##              
##
###
##########################################################################

##########################################################################
##
## FUNCTION DEFINITIONS
##
##########################################################################

##########################################
## INIT_FILE ()
##
function INIT_FILE () 
{
FILE=$1 ;
echo " " > ${FILE} ;
}


##########################################
## INSERT_BLANK_LINE ()
##
function INSERT_BLANK_LINE () 
{
FILE=$1 ;
echo " " >> ${FILE} ;
}

##########################################
## INSERT_LINE ()
##
function INSERT_LINE () 
{
FILE=$1 ;
echo "$2" >> ${FILE} ;
}


function DMTF_DIR_ADD ()
{
FILE=$1 ;

ls -R | grep DMTF | sed 's/DMTF$//' | sed 's/.\/DMTF/cvs -n add .\/CIM211\/DMTF/' | sed 's/://' >> ${FILE} ;
}


function DMTF_CIM_FILE_ADD ()
{
FILE=$1 ;

ls -R | grep DMTF | sed 's/DMTF$//' | sed 's/.\/DMTF/cvs -n add .\/CIM211\/DMTF/' | sed 's/:/\/*.mof /' >> ${FILE} ;
}

function DMTF_CIM_FILE_CI ()
{
FILE=$1 ;

ls -R | grep DMTF | sed 's/DMTF$//' | sed 's/.\/DMTF/cvs -n ci .\/CIM211\/DMTF/' | sed 's/:/\/*.mof /' >> ${FILE} ;
}

CKIN_FILE=ckin_dmtf_files

##########################################################################
##
## Create the files
##
##########################################################################

INIT_FILE $CKIN_FILE
INSERT_LINE $CKIN_FILE "#!/bin/bash"
INSERT_LINE $CKIN_FILE "######################################################"
INSERT_LINE $CKIN_FILE "## This file is generated by create_ckin_script script"
INSERT_LINE $CKIN_FILE "######################################################"
INSERT_BLANK_LINE $CKIN_FILE
INSERT_LINE $CKIN_FILE "## "
INSERT_LINE $CKIN_FILE "## After reviewing this file for correctness "
INSERT_LINE $CKIN_FILE "## change the cvs -n to cvs "
INSERT_LINE $CKIN_FILE "## and execute it from the CIM211 directory"
INSERT_LINE $CKIN_FILE "## "
INSERT_BLANK_LINE $CKIN_FILE

INSERT_LINE $CKIN_FILE "cd .. ; "
INSERT_LINE $CKIN_FILE "cvs -n add ./CIM211 ; "

INSERT_BLANK_LINE $CKIN_FILE
INSERT_LINE $CKIN_FILE "## add directories"
INSERT_BLANK_LINE $CKIN_FILE
DMTF_DIR_ADD $CKIN_FILE
INSERT_BLANK_LINE $CKIN_FILE

INSERT_LINE $CKIN_FILE "## add *.mof files"
INSERT_BLANK_LINE $CKIN_FILE
DMTF_CIM_FILE_ADD $CKIN_FILE
INSERT_BLANK_LINE $CKIN_FILE

INSERT_LINE $CKIN_FILE "## commit *.mof files"
INSERT_BLANK_LINE $CKIN_FILE
DMTF_CIM_FILE_CI $CKIN_FILE
INSERT_BLANK_LINE $CKIN_FILE

INSERT_LINE $CKIN_FILE "## add CIM211/ files"
INSERT_BLANK_LINE $CKIN_FILE
INSERT_LINE $CKIN_FILE "cvs -n add ./CIM211/*.mof"
INSERT_LINE $CKIN_FILE "cvs -n add ./CIM211/header_add.txt"
INSERT_LINE $CKIN_FILE "cvs -n add ./CIM211/create_interface_files"
INSERT_LINE $CKIN_FILE "cvs -n add ./CIM211/create_ckin_script"
INSERT_LINE $CKIN_FILE "cvs -n add ./CIM211/ckin_dmtf_files"
INSERT_LINE $CKIN_FILE "cvs -n add ./CIM211/readme"
INSERT_BLANK_LINE $CKIN_FILE

INSERT_LINE $CKIN_FILE "## commit CIM211/files"
INSERT_BLANK_LINE $CKIN_FILE
INSERT_LINE $CKIN_FILE "cvs -n ci ./CIM211/*.mof"
INSERT_LINE $CKIN_FILE "cvs -n ci ./CIM211/header_add.txt"
INSERT_LINE $CKIN_FILE "cvs -n ci ./CIM211/create_interface_files"
INSERT_LINE $CKIN_FILE "cvs -n ci ./CIM211/create_ckin_script"
INSERT_LINE $CKIN_FILE "cvs -n ci ./CIM211/ckin_dmtf_files"
INSERT_LINE $CKIN_FILE "cvs -n ci ./CIM211/readme"
INSERT_BLANK_LINE $CKIN_FILE


chmod ugo+x $CKIN_FILE

echo " "
echo "ckin script $CKIN_FILE created, It must be hand edited to finalize"

