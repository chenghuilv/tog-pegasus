include $(PEGASUS_ROOT)/mak/config.mak

CP = cp

SDK_STAGINGDIR = $(PEGASUS_HOME)/stageSDK

INCLUDE_SRCPATH = $(PEGASUS_ROOT)/src
INCLUDE_DESTPATH = $(SDK_STAGINGDIR)/include

HTML_SRCPATH = $(PEGASUS_HOME)/html
HTML_DESTPATH = $(SDK_STAGINGDIR)/html

CLIENT_SRCPATH1 = $(PEGASUS_ROOT)/src/SDK/samples
CLIENT_SRCPATH2 = $(PEGASUS_ROOT)/InterfaceArchive/v002001/tests/Clients

PROVIDER_SRCPATH1 = $(PEGASUS_ROOT)/src/SDK/samples/Providers
PROVIDER_SRCPATH2 = $(PEGASUS_ROOT)/src/Providers/sample
PROVIDER_SRCPATH3 = $(PEGASUS_ROOT)/InterfaceArchive/v002001/tests/Providers

SAMPLE_DESTPATH = $(SDK_STAGINGDIR)

INCLUDEFILES = \
   Pegasus/Client/CIMClientException.h \
   Pegasus/Client/CIMClient.h \
   Pegasus/Client/Linkage.h \
   Pegasus/Common/Array.h \
   Pegasus/Common/ArrayInter.h \
   Pegasus/Common/Char16.h \
   Pegasus/Common/CIMClass.h \
   Pegasus/Common/CIMDateTime.h \
   Pegasus/Common/CIMFlavor.h \
   Pegasus/Common/CIMIndication.h \
   Pegasus/Common/CIMInstance.h \
   Pegasus/Common/CIMMethod.h \
   Pegasus/Common/CIMName.h \
   Pegasus/Common/CIMObject.h \
   Pegasus/Common/CIMObjectPath.h \
   Pegasus/Common/CIMParameter.h \
   Pegasus/Common/CIMParamValue.h \
   Pegasus/Common/CIMProperty.h \
   Pegasus/Common/CIMPropertyList.h \
   Pegasus/Common/CIMQualifierDecl.h \
   Pegasus/Common/CIMQualifier.h \
   Pegasus/Common/CIMScope.h \
   Pegasus/Common/CIMStatusCode.h \
   Pegasus/Common/CIMType.h \
   Pegasus/Common/CIMValue.h \
   Pegasus/Common/Config.h \
   Pegasus/Common/Exception.h \
   Pegasus/Common/Linkage.h \
   Pegasus/Common/OperationContext.h \
   Pegasus/Common/ResponseHandler.h \
   Pegasus/Common/SSLContext.h \
   Pegasus/Common/String.h \
   Pegasus/Common/Platform_$(PEGASUS_PLATFORM).h \
   Pegasus/Consumer/CIMIndicationConsumer.h \
   Pegasus/Consumer/Linkage.h \
   Pegasus/Provider/CIMAssociationProvider.h \
   Pegasus/Provider/CIMIndicationConsumerProvider.h \
   Pegasus/Provider/CIMIndicationProvider.h \
   Pegasus/Provider/CIMInstanceProvider.h \
   Pegasus/Provider/CIMMethodProvider.h \
   Pegasus/Provider/CIMOMHandle.h \
   Pegasus/Provider/CIMProvider.h \
   Pegasus/Provider/Linkage.h \
   Pegasus/Provider/ProviderException.h \
   Pegasus/Provider/CMPI/cmpidt.h \
   Pegasus/Provider/CMPI/cmpift.h \
   Pegasus/Provider/CMPI/cmpimacs.h \
   Pegasus/Provider/CMPI/CmpiArgs.h \
   Pegasus/Provider/CMPI/CmpiArray.h \
   Pegasus/Provider/CMPI/CmpiAssociationMI.h \
   Pegasus/Provider/CMPI/CmpiBaseMI.h \
   Pegasus/Provider/CMPI/CmpiBooleanData.h \
   Pegasus/Provider/CMPI/CmpiBroker.h \
   Pegasus/Provider/CMPI/CmpiCharData.h \
   Pegasus/Provider/CMPI/CmpiContext.h \
   Pegasus/Provider/CMPI/CmpiData.h \
   Pegasus/Provider/CMPI/CmpiDateTime.h \
   Pegasus/Provider/CMPI/CmpiEnumeration.h \
   Pegasus/Provider/CMPI/CmpiIndicationMI.h \
   Pegasus/Provider/CMPI/CmpiInstance.h \
   Pegasus/Provider/CMPI/CmpiInstanceMI.h \
   Pegasus/Provider/CMPI/CmpiIndicationMI.h \
   Pegasus/Provider/CMPI/CmpiMethodMI.h \
   Pegasus/Provider/CMPI/CmpiObject.h \
   Pegasus/Provider/CMPI/CmpiObjectPath.h \
   Pegasus/Provider/CMPI/CmpiPropertyMI.h \
   Pegasus/Provider/CMPI/CmpiProviderBase.h \
   Pegasus/Provider/CMPI/CmpiResult.h \
   Pegasus/Provider/CMPI/CmpiSelectExp.h \
   Pegasus/Provider/CMPI/CmpiStatus.h \
   Pegasus/Provider/CMPI/CmpiString.h

INCLUDEFILES += \
   Pegasus/Common/AcceptLanguages.h \
   Pegasus/Common/MessageLoader.h \
   Pegasus/Common/ContentLanguages.h \
   Pegasus/Common/LanguageElementContainer.h \
   Pegasus/Common/AcceptLanguageElement.h \
   Pegasus/Common/Formatter.h \
   Pegasus/Common/ContentLanguage.h \
   Pegasus/Common/ContentLanguageElement.h \
   Pegasus/Common/LanguageParser.h \
   Pegasus/Common/LanguageElement.h  


CLIENTSRCPATH1FILES = \
   Makefile \
   mak/$(PEGASUS_PLATFORM).mak \
   mak/config.mak \
   mak/program.mak \
   mak/recurse.mak \
   mak/library.mak \
   mak/common.mak \
   Clients/Makefile \
   Clients/DefaultC++/Makefile \
   Clients/DefaultC++/EnumInstances/Makefile \
   Clients/DefaultC++/InvokeMethod/Makefile  

CLIENTSRCPATH2FILES = \
   EnumInstances/EnumInstances.cpp \
   InvokeMethod/InvokeMethod.cpp \

PROVIDERSRCPATH1FILES = \
   Makefile \
   Load/Makefile \
   DefaultC++/Makefile \
   DefaultC++/InstanceProvider/Makefile \
   DefaultC++/MethodProvider/Makefile
   
PROVIDERSRCPATH2FILES = \
   Load/CWS_FilesAndDir.mof \
   Load/CWS_FilesAndDirR.mof \
   Load/RT_Indication.mof \
   Load/IndicationProviderR.mof \
   Load/InstanceProviderR.mof \
   Load/MethodProviderR.mof \
   Load/SimpleDisplayConsumerR.mof \
   Load/SampleProviderSchema.mof \

PROVIDERSRCPATH3FILES = \
   InstanceProvider/InstanceProvider.cpp \
   InstanceProvider/InstanceProviderMain.cpp \
   InstanceProvider/InstanceProvider.h \
   InstanceProvider/EnumerateInstancesrspgood.xml \
   InstanceProvider/EnumerateInstances.xml \
   MethodProvider/MethodProvider.cpp \
   MethodProvider/MethodProviderMain.cpp \
   MethodProvider/MethodProvider.h \
   MethodProvider/InvokeMethod.xml \
   MethodProvider/InvokeMethodrspgood.xml

error:
	@echo "Please specify an action"

stageSDK:
	@$(RMDIRHIER) $(SDK_STAGINGDIR)
	$(MAKE) -f SDKMakefile stageINCLUDE
	$(MAKE) -f SDKMakefile stageHTML
	$(MAKE) -f SDKMakefile stageSAMPLES

stageINCLUDE:
	@$(RMDIRHIER) $(INCLUDE_DESTPATH)
	@$(MKDIRHIER) $(INCLUDE_DESTPATH)/Pegasus/Common
	@$(MKDIRHIER) $(INCLUDE_DESTPATH)/Pegasus/Client
	@$(MKDIRHIER) $(INCLUDE_DESTPATH)/Pegasus/Provider
	@$(MKDIRHIER) $(INCLUDE_DESTPATH)/Pegasus/Provider/CMPI
	@$(MKDIRHIER) $(INCLUDE_DESTPATH)/Pegasus/Handler
	@$(MKDIRHIER) $(INCLUDE_DESTPATH)/Pegasus/Consumer
	@$(foreach i, $(INCLUDEFILES), $(CP) $(INCLUDE_SRCPATH)/$(i) $(INCLUDE_DESTPATH)/$(i);)

stageSAMPLES:
	@$(RMDIRHIER) $(SAMPLE_DESTPATH)/samples
	@$(MKDIRHIER) $(SAMPLE_DESTPATH)/samples/mak
	@$(MKDIRHIER) $(SAMPLE_DESTPATH)/samples/Clients/DefaultC++/EnumInstances
	@$(MKDIRHIER) $(SAMPLE_DESTPATH)/samples/Clients/DefaultC++/InvokeMethod
	@$(MKDIRHIER) $(SAMPLE_DESTPATH)/samples/Providers/Load
	@$(MKDIRHIER) $(SAMPLE_DESTPATH)/samples/Providers/DefaultC++/InstanceProvider
	@$(MKDIRHIER) $(SAMPLE_DESTPATH)/samples/Providers/DefaultC++/MethodProvider
	@$(foreach i, $(CLIENTSRCPATH1FILES), $(CP) $(CLIENT_SRCPATH1)/$(i) $(SAMPLE_DESTPATH)/samples/$(i);)
	@$(foreach i, $(CLIENTSRCPATH2FILES), $(CP) $(CLIENT_SRCPATH2)/$(i) $(SAMPLE_DESTPATH)/samples/Clients/DefaultC++/$(i);)
	@$(foreach i, $(PROVIDERSRCPATH1FILES), $(CP) $(PROVIDER_SRCPATH1)/$(i) $(SAMPLE_DESTPATH)/samples/Providers/$(i);)
	@$(foreach i, $(PROVIDERSRCPATH2FILES), $(CP) $(PROVIDER_SRCPATH2)/$(i) $(SAMPLE_DESTPATH)/samples/Providers/$(i);)
	@$(foreach i, $(PROVIDERSRCPATH3FILES), $(CP) $(PROVIDER_SRCPATH3)/$(i) $(SAMPLE_DESTPATH)/samples/Providers/DefaultC++/$(i);)

stageHTML:
	@$(RMDIRHIER) $(HTML_DESTPATH)
	@$(MKDIRHIER) $(HTML_DESTPATH)
	$(MAKE) --directory=$(PEGASUS_ROOT)/doc/SDK -f Makefile HTML_DESTPATH=$(HTML_DESTPATH) buildDoc

buildSDK:
	@$(MAKE) --directory=$(SAMPLE_DESTPATH)/samples -f Makefile PEGASUS_LIB_DIR=$(PEGASUS_HOME)/lib \
             PEGASUS_PROVIDER_LIB_DIR=$(PEGASUS_HOME)/lib PEGASUS_INCLUDES="-I $(INCLUDE_DESTPATH)" \
             CIM_MOF_PATH=$(PEGASUS_ROOT)/Schemas/CIM27 clean
	@$(MAKE) --directory=$(SAMPLE_DESTPATH)/samples -f Makefile PEGASUS_LIB_DIR=$(PEGASUS_HOME)/lib \
             PEGASUS_PROVIDER_LIB_DIR=$(PEGASUS_HOME)/lib PEGASUS_INCLUDES="-I $(INCLUDE_DESTPATH)" \
             CIM_MOF_PATH=$(PEGASUS_ROOT)/Schemas/CIM27 SAMPLES_DIR=$(SAMPLE_DESTPATH)/samples

deregProviders:
	@$(MAKE) --directory=$(SAMPLE_DESTPATH)/samples/Providers/Load -f Makefile deregisterproviders

regProviders:
	@$(MAKE) --directory=$(SAMPLE_DESTPATH)/samples/Providers/Load -f Makefile registerproviders

testSDK:
	@$(MAKE) --directory=$(SAMPLE_DESTPATH)/samples -f Makefile PEGASUS_LIB_DIR=$(PEGASUS_HOME)/lib \
             PEGASUS_PROVIDER_LIB_DIR=$(PEGASUS_HOME)/lib PEGASUS_INCLUDES="-I $(INCLUDE_DESTPATH)" \
             CIM_MOF_PATH=$(PEGASUS_ROOT)/Schemas/CIM27 SAMPLES_DIR=$(SAMPLE_DESTPATH)/samples tests

